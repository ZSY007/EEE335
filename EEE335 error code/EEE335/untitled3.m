clc;
clear;

% 导纳矩阵 (Y)
Y = [
    8.33 - 16.67j, -5 + 10j, -3.33 + 6.67j;
    -5 + 10j, 9 - 18j, -4 + 8j;
    -3.33 + 6.67j, -4 + 8j, 7.33 - 14.67j
];

% 节点功率
P2 = -1.0; Q2 = -0.5; % PQ节点2
P3 = -0.8; Q3 = -0.4; % PQ节点3

% 初始电压假设
V = [1.05; 1 + 0j; 1 + 0j]; % 初始电压
tolerance = 1e-4; % 收敛准则
max_iter = 100; % 最大迭代次数
iter = 0; % 迭代计数器

% 高斯-赛德尔迭代
while iter < max_iter
    iter = iter + 1;
    V_old = V; % 记录旧电压值
    
    % 更新PQ节点2的电压
    V(2) = (1 / Y(2,2)) * ...
        ((P2 - 1j * Q2) / conj(V(2)) - (Y(2,1) * V(1) + Y(2,3) * V(3)));
    
    % 更新PQ节点3的电压
    V(3) = (1 / Y(3,3)) * ...
        ((P3 - 1j * Q3) / conj(V(3)) - (Y(3,1) * V(1) + Y(3,2) * V(2)));
    
    % 检查收敛条件
    if max(abs(V - V_old)) < tolerance
        break;
    end
end

% 输出结果
disp('高斯-赛德尔法收敛电压:');
disp(V);
disp(['收敛迭代次数: ', num2str(iter)]);
